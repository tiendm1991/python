class Solution:
    def boxDelivering(self, boxes, portsCount: int, maxBoxes: int, maxWeight: int) -> int:
        MAX_INT = 10 ** 9 + 7
        n = len(boxes)
        dp = [MAX_INT] * (n + 1)
        dp[0] = 0
        for i in range(1, n + 1):
            j = i
            w = 0
            t = 2
            while j >= max(1, i - maxBoxes + 1) and w + boxes[j - 1][1] <= maxWeight:
                if j < i and boxes[j - 1][0] != boxes[j][0]:
                    t += 1
                dp[i] = min(dp[i], dp[j - 1] + t)
                w += boxes[j - 1][1]
                j -= 1
        return dp[-1]


s = Solution()
print(s.boxDelivering([[1, 1], [2, 1], [1, 1]], 2, 3, 3))
# print(s.boxDelivering([[1, 4], [1, 2], [2, 1], [2, 1], [3, 2], [3, 4]], 3, 6, 7))
# print(s.boxDelivering([[2, 4], [2, 5], [3, 1], [3, 2], [3, 7], [3, 1], [4, 4], [1, 3], [5, 2]], 5, 5, 7))
# print(s.boxDelivering(
#     [[179, 7243], [205, 17888], [138, 13004], [88, 10199], [103, 39432], [27, 27228], [100, 10336], [154, 16730],
#      [213, 36824], [56, 14157], [139, 44285], [106, 33434], [122, 433], [69, 32992], [171, 13690], [54, 33237],
#      [6, 32159], [172, 9907], [104, 1143], [16, 4476], [134, 13953], [28, 13027], [9, 1727], [216, 6847], [113, 6177],
#      [99, 22582], [82, 26863], [132, 16460], [180, 28236], [132, 31569], [188, 19328], [100, 31674], [108, 24331],
#      [166, 15254], [34, 42089], [118, 40971], [73, 39603], [57, 20045], [146, 45397], [46, 45797], [18, 37124],
#      [87, 751], [8, 11372], [77, 31694], [9, 3674], [17, 4783], [44, 46608], [205, 12982], [178, 14817], [148, 2763],
#      [97, 43969], [158, 40869], [127, 37418], [74, 21179], [194, 31732], [90, 33169], [112, 42632], [76, 44347],
#      [124, 22602], [177, 25118], [112, 37623], [216, 12001], [14, 4818], [124, 26518], [68, 41429], [36, 31701],
#      [157, 45400], [23, 20090], [40, 5189], [205, 4203], [150, 29106], [185, 16388], [53, 3540], [183, 2875],
#      [52, 45876], [156, 32816], [112, 30184], [39, 22735], [85, 21660], [158, 46620], [137, 14775], [20, 8403],
#      [189, 40078], [25, 3640], [105, 36757], [80, 16847], [170, 3660], [216, 9262], [191, 16838], [169, 10741],
#      [5, 39390], [158, 10903], [16, 7077], [213, 466], [11, 29809], [9, 20859], [59, 2775], [36, 19932], [161, 46199],
#      [175, 24625], [76, 40231], [178, 35648], [194, 35105], [40, 44728], [3, 41636], [121, 27469], [16, 9395],
#      [114, 44182], [195, 11158], [169, 31139], [119, 20037], [130, 24959], [112, 12236], [91, 18326], [7, 16690],
#      [213, 12294], [178, 47091], [119, 28579], [152, 22393], [94, 18992], [132, 43471], [5, 26759], [186, 16988],
#      [123, 45040], [45, 18628], [94, 38813], [9, 23755], [152, 34555], [81, 43925], [215, 13423], [141, 30617],
#      [47, 33711], [206, 8713], [210, 36402], [170, 26984], [119, 11984], [10, 25019], [164, 18286], [60, 44768],
#      [149, 25669], [55, 38262], [38, 5791], [214, 46482], [40, 22284], [115, 41833], [201, 43977], [91, 17717],
#      [206, 19353], [186, 11866], [177, 11296], [63, 17638], [34, 27963], [76, 42343], [126, 18664], [86, 3655],
#      [75, 4148], [195, 44050], [166, 28298], [161, 40747], [215, 40475], [193, 35323], [32, 22873], [10, 39749],
#      [107, 13640], [108, 42742], [44, 22870], [46, 38176], [213, 34137], [157, 37407], [24, 16568], [118, 22507],
#      [46, 9414], [60, 190], [180, 15616], [33, 36649], [206, 43212], [24, 45404], [149, 22485], [17, 10092],
#      [99, 22466], [6, 7394], [184, 22507], [80, 7992], [6, 32349], [78, 3612], [170, 15659], [196, 9173], [7, 45835],
#      [6, 21727], [85, 11160], [189, 39970], [70, 15644], [102, 3882], [141, 15349], [147, 44934], [42, 25726],
#      [58, 31620], [151, 25060], [168, 28125], [118, 29680], [30, 15172], [189, 33730], [109, 20561], [153, 37771],
#      [144, 26350], [70, 4349], [56, 42950], [168, 19671], [26, 14734], [148, 23635], [143, 29237], [101, 32712],
#      [164, 39808], [17, 10810], [62, 41754], [211, 30292], [176, 37845], [3, 23610], [173, 6492], [71, 17504],
#      [32, 4308], [84, 36087], [113, 22114], [85, 31422], [136, 38144], [50, 9973], [52, 1922], [143, 21172],
#      [145, 19700], [28, 35874], [86, 2557], [50, 18589], [208, 34543], [128, 30901], [118, 18472], [65, 1046],
#      [203, 29817], [200, 30659], [201, 43444], [170, 30241], [14, 23252], [110, 33106], [135, 19006], [203, 29300],
#      [90, 36559], [158, 586], [200, 37704], [111, 43526], [140, 41105], [92, 27777], [127, 36773], [51, 11152],
#      [20, 29164], [150, 43544], [147, 44802], [73, 28341], [155, 17949], [68, 20940], [212, 6186], [198, 30348],
#      [35, 13909], [44, 43975], [9, 19118], [89, 23777], [79, 16396], [60, 45824], [64, 19467], [35, 4119], [171, 1879],
#      [165, 3387], [206, 2117], [81, 39846], [95, 22380], [13, 29349], [11, 17023], [66, 26353], [199, 29553],
#      [211, 46645], [46, 14349], [102, 21830], [117, 41563], [197, 12282], [148, 23583], [18, 37877], [53, 763],
#      [52, 41739], [145, 12824], [108, 12545], [150, 2872], [56, 23133], [215, 841], [106, 12642], [153, 31276],
#      [144, 27749], [91, 24232], [140, 42303], [194, 24819], [86, 31768], [68, 35969], [89, 8403], [160, 32599],
#      [128, 2156], [206, 27881], [147, 15127], [99, 23725], [7, 22780], [34, 20977], [48, 37100], [134, 1121],
#      [189, 20631], [9, 39859], [119, 3113], [160, 32999], [10, 19797], [183, 20989], [83, 3501], [104, 26458],
#      [87, 6438], [192, 26734], [112, 7856], [200, 5004], [203, 7518], [41, 22607], [139, 9825], [119, 31361],
#      [18, 18878], [45, 12894], [41, 19610], [22, 27572], [128, 19888], [31, 27090], [32, 17307], [174, 40567],
#      [107, 4829], [177, 45051], [89, 26341], [194, 39002], [181, 22322], [156, 24556], [148, 33654], [198, 27130],
#      [179, 20045], [170, 41048], [5, 25666], [125, 20436], [205, 19926], [92, 16360], [149, 3639], [105, 40560],
#      [186, 15608], [112, 9924], [186, 39069], [150, 29182], [153, 24719], [197, 34704], [171, 28461], [191, 27233],
#      [192, 15704], [34, 38362], [101, 13161], [182, 2929], [188, 31968], [39, 20565], [155, 40662], [186, 44479],
#      [53, 12865], [160, 32151], [216, 8172], [206, 45329], [78, 39028], [16, 12968], [153, 6550], [5, 15400],
#      [180, 21293], [168, 44710], [60, 46095], [110, 10089], [86, 45214], [176, 46371], [32, 37813], [110, 8054],
#      [49, 23163], [203, 24933], [106, 43514], [171, 376], [28, 31771], [43, 12032], [12, 5602], [125, 32421],
#      [146, 41518], [143, 11747], [100, 10039], [13, 12202], [91, 6031], [64, 47000], [36, 23054], [141, 8399],
#      [86, 10025], [111, 9153], [24, 36379], [155, 13826], [127, 20537], [11, 45051], [33, 43216], [208, 35223],
#      [108, 7255], [164, 38419], [31, 39277], [24, 2002], [134, 42597], [155, 16313], [71, 15658], [178, 43703],
#      [204, 24244], [47, 35058], [207, 27781], [116, 16053], [128, 39919], [199, 9331], [40, 28330], [87, 16860],
#      [202, 1878], [119, 27656], [211, 36649], [195, 45395], [167, 11121], [108, 11828], [157, 25567], [129, 5427],
#      [13, 16206], [200, 35545], [132, 39932], [83, 38602], [25, 26955], [138, 44636], [49, 9468], [128, 32117],
#      [20, 6154], [182, 28545], [99, 10041], [129, 3029], [198, 40641], [143, 7602], [51, 6329], [204, 26471],
#      [159, 25129], [175, 45832], [156, 34087], [107, 36031], [127, 8236], [188, 34233], [92, 15685], [71, 39464],
#      [1, 37117], [172, 31827], [199, 32835], [9, 19238], [155, 16955], [207, 313], [4, 3604], [79, 41753], [190, 22402],
#      [2, 14455], [154, 35507], [149, 14244], [2, 1048], [113, 24904], [44, 39134], [66, 7337], [126, 39349],
#      [208, 2587], [124, 37064], [161, 47409], [69, 1077], [56, 25012], [100, 46468], [133, 2569], [213, 28037],
#      [112, 34294], [108, 7616], [102, 22565], [75, 38401], [194, 17694], [132, 43653], [76, 39592], [40, 47486],
#      [156, 34050], [115, 36336], [160, 9386], [168, 37827], [92, 42563], [145, 15188], [28, 43625], [143, 35976],
#      [82, 3230], [176, 34026], [144, 16180], [181, 46227], [62, 29330], [10, 23409], [71, 79], [176, 29958],
#      [127, 38930], [162, 15640], [210, 44282], [193, 13083], [91, 25426], [12, 22538]],
#     216,
#     3,
#     47520))
